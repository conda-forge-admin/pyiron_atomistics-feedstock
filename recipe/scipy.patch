From 85d95ae571bc8ab18b40843357581db07114fdee Mon Sep 17 00:00:00 2001
From: Jan Janssen <jan-janssen@users.noreply.github.com>
Date: Mon, 7 Feb 2022 12:47:06 -0700
Subject: [PATCH] Update analyse.py

---
 pyiron_atomistics/atomistics/structure/analyse.py | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/pyiron_atomistics/atomistics/structure/analyse.py b/pyiron_atomistics/atomistics/structure/analyse.py
index c9cbe8de3..d71a9de11 100644
--- a/pyiron_atomistics/atomistics/structure/analyse.py
+++ b/pyiron_atomistics/atomistics/structure/analyse.py
@@ -6,7 +6,6 @@
 from sklearn.cluster import AgglomerativeClustering, DBSCAN
 from scipy.sparse import coo_matrix
 from scipy.spatial import Voronoi, Delaunay
-from scipy.spatial.qhull import _QhullUser
 from pyiron_atomistics.atomistics.structure.pyscal import (
     get_steinhardt_parameter_structure,
     analyse_cna_adaptive,
@@ -20,6 +19,11 @@
 from scipy.spatial import ConvexHull
 from typing import Type
 
+try:  # scipy <1.8
+    from scipy.spatial.qhull import _QhullUser
+except ImportError:  # scipy >= 1.8
+    from scipy.spatial._qhull import _QhullUser
+
 deprecate = Deprecator()
 
 __author__ = "Joerg Neugebauer, Sam Waseda"
